
'use strict';var ShapeToClass={'X':'cross','O':'circle'};var WIN_COMBINATIONS=[[1,1,1,0,0,0,0,0,0],[0,0,0,1,1,1,0,0,0],[0,0,0,0,0,0,1,1,1],[1,0,0,1,0,0,1,0,0],[0,1,0,0,1,0,0,1,0],[0,0,1,0,0,1,0,0,1],[1,0,0,0,1,0,0,0,1],[0,0,1,0,1,0,1,0,0]];var playerNum=0;var players=[{shape:'X',moves:[0,0,0,0,0,0,0,0,0]},{shape:'O',moves:[0,0,0,0,0,0,0,0,0]}];var messageText=document.querySelector('.message__text');var messagePlayer=document.querySelector('.message__player');var restartBtn=document.querySelector('.restart-btn');var grid=document.querySelector('.grid');var cells=Array.from(grid.children);function runGame(){restartBtn.addEventListener('click',function(){return window.location.reload();});grid.addEventListener('click',cellClickHandler);showGameStatus();}
function stopGame(){grid.removeEventListener('click',cellClickHandler);cells.forEach(function(cell){return cell.classList.add('grid__cell--off');});showRestartBtn();}
runGame();function showGameStatus(isWin,isDraw){var currentPlayer=players[playerNum].shape;messagePlayer.textContent=currentPlayer;messagePlayer.classList.remove('message__player--hide');messagePlayer.classList.remove("message__player--".concat(ShapeToClass['X']));messagePlayer.classList.remove("message__player--".concat(ShapeToClass['O']));messagePlayer.classList.add("message__player--".concat(ShapeToClass[currentPlayer]));if(isWin){messageText.textContent='And the winner is...';}else if(isDraw){messageText.textContent='Draw';messagePlayer.textContent='';messagePlayer.classList.add('message__player--hide');}else{messageText.textContent='Choose the cell for';}}
function showPlayerMove(cell){var playerShape=players[playerNum].shape;cell.classList.add("grid__cell--".concat(ShapeToClass[playerShape]));}
function showRestartBtn(){restartBtn.classList.remove('restart-btn--hide');}
function showWinMoves(winFieldset){for(var i=0;i<winFieldset.length;i++){if(winFieldset[i]==1)cells[i].classList.add('win');}}
function changePlayer(){playerNum=playerNum==0?1:0;}
function savePlayerMove(cellId){players[playerNum].moves[cellId]=1;}
function isEmptyCell(cell){var shapes=Object.keys(ShapeToClass);return shapes.every(function(shape){return!cell.classList.contains("grid__cell--".concat(ShapeToClass[shape]));});}
function checkWin(){var moves=[];for(var i=0;i<WIN_COMBINATIONS.length;i++){moves.push([]);for(var j=0;j<WIN_COMBINATIONS[i].length;j++){moves[i][j]=players[playerNum].moves[j]*WIN_COMBINATIONS[i][j];}}
for(var _i=0;_i<WIN_COMBINATIONS.length;_i++){if(moves[_i].join()==WIN_COMBINATIONS[_i].join()){showWinMoves(WIN_COMBINATIONS[_i]);return true;}}
return false;}
function checkDraw(){return!cells.some(function(cell){return isEmptyCell(cell);});}
function cellClickHandler(evt){var cell=evt.target;if(isEmptyCell(cell)){savePlayerMove(cell.id);showPlayerMove(cell);var isWin=checkWin();var isDraw=checkDraw();if(isWin||isDraw){stopGame();}else{changePlayer();}
showGameStatus(isWin,isDraw);}}